#!/bin/bash
if ! [ -x "$(command -v tmux)" ]; then
    echo "Installing tmux..." >&2
    sudo apt install -y tmux;
fi

[ -f ~/.tmux.conf ] && mv ~/.tmux.conf ~/.tmux.conf_bak`date +%y%m%d_%H%M`
[ -f ~/.tmux.conf.local ] && mv ~/.tmux.conf.local ~/.tmux.conf.local_bak`date +%y%m%d_%H%M`

DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" >/dev/null 2>&1 && pwd)"

if [ "$1" == "link" ]; then
	[ ! -f "$DIR"/tmux.conf ] && 
		echo "[ERROR] 'tmux.conf' not found!" && exit || 
		ln -s -f "$DIR"/tmux.conf ~/.tmux.conf && 
		echo "[LINK] ~/.tmux.conf" && ls -l ~/.tmux.conf

	[ ! -f "$DIR"/tmux.conf.local ] && 
		echo "[ERROR] 'tmux.conf.local' not found!" && exit || 
		ln -s -f "$DIR"/tmux.conf.local ~/.tmux.conf.local && 
		echo "[LINK] ~/.tmux.conf.local" && ls -l ~/.tmux.conf.local
else
	[ ! -f "$DIR"/tmux.conf ] && 
		echo "[ERROR] 'tmux.conf' not found!" && exit || 
		cp "$DIR"/tmux.conf ~/.tmux.conf && 
		echo "[COPY] ~/.tmux.conf" && ls -l ~/.tmux.conf

	[ ! -f "$DIR"/tmux.conf.local ] && 
		echo "[ERROR] 'tmux.conf.local' not found!" && exit || 
		cp "$DIR"/tmux.conf.local ~/.tmux.conf.local && 
		echo "[COPY] ~/.tmux.conf.local" && ls -l ~/.tmux.conf.local
fi
